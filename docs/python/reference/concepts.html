

<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>コンセプト &mdash; Boost.Python（日本語訳）  ドキュメント</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="高水準コンポーネント" href="components.html" />
    <link rel="prev" title="リファレンスマニュアル" href="../reference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Boost.Python（日本語訳）
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目次</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">リリースノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building.html">ビルドとテスト</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">リファレンスマニュアル</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">コンセプト</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">高水準コンポーネント</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html">オブジェクトラッパ</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html">関数の呼び出しと作成</a></li>
<li class="toctree-l2"><a class="reference internal" href="conversion.html">Python との型変換</a></li>
<li class="toctree-l2"><a class="reference internal" href="embedding.html">組み込み</a></li>
<li class="toctree-l2"><a class="reference internal" href="utility.html">ユーティリティとインフラストラクチャ</a></li>
<li class="toctree-l2"><a class="reference internal" href="topics.html">トピック</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">用語</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">設定に関する情報</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">用語</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">サポートリソース</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">よくある質問と回答</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numpy/index.html">Boost.Python（NumPy）</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../platforms.html">動作を確認したプラットフォームとコンパイラ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Boost.Python を使用しているプロジェクト</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../internals.html">Boost.Python の裏側</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news.html">新着情報・変更履歴</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">TODO リスト</a></li>
<li class="toctree-l1"><a class="reference internal" href="../progress_reports.html">LLNL 進捗レポート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">謝辞</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Boost.Python（日本語訳）</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../reference.html">リファレンスマニュアル</a> &raquo;</li>
        
      <li>コンセプト</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/reference/concepts.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>コンセプト<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="contents local topic" id="id2">
<p class="topic-title">目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#callpolicies" id="id26">CallPolicies コンセプト</a></p>
<ul>
<li><p><a class="reference internal" href="#concepts-callpolicies-introduction" id="id27">はじめに</a></p></li>
<li><p><a class="reference internal" href="#concepts-callpolicies-callpolicies-composition" id="id28">CallPolicies の合成</a></p></li>
<li><p><a class="reference internal" href="#concepts-callpolicies-concept-requirements" id="id29">コンセプトの要件</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dereferenceable" id="id30">Dereferenceable コンセプト</a></p>
<ul>
<li><p><a class="reference internal" href="#concepts-dereferenceable-introduction" id="id31">はじめに</a></p></li>
<li><p><a class="reference internal" href="#concepts-dereferenceable-concept-requirements" id="id32">コンセプトの要件</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#extractor" id="id33">Extractor コンセプト</a></p>
<ul>
<li><p><a class="reference internal" href="#concepts-extractor-introduction" id="id34">はじめに</a></p></li>
<li><p><a class="reference internal" href="#concepts-extractor-concept-requirements" id="id35">コンセプトの要件</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#holdergenerator" id="id36">HolderGenerator コンセプト</a></p>
<ul>
<li><p><a class="reference internal" href="#concepts-holdergenerator-introduction" id="id37">はじめに</a></p></li>
<li><p><a class="reference internal" href="#concepts-holdergenerator-concept-requirements" id="id38">コンセンプトの要件</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#resultconverter-resultconvertergenerator" id="id39">ResultConverter/ResultConverterGenerator コンセプト</a></p>
<ul>
<li><p><a class="reference internal" href="#concepts-resultconverter-introduction" id="id40">はじめに</a></p></li>
<li><p><a class="reference internal" href="#concepts-resultconverter-resultconverter-concept-requirem" id="id41">コンセプトの要件</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#objectwrapper-typewrapper" id="id42">ObjectWrapper/TypeWrapper コンセプト</a></p>
<ul>
<li><p><a class="reference internal" href="#concepts-objectwrapper-introduction" id="id43">はじめに</a></p></li>
<li><p><a class="reference internal" href="#concepts-objectwrapper-objectwrapper-concept-requiremen" id="id44">コンセプトの要件</a></p></li>
<li><p><a class="reference internal" href="#concepts-objectwrapper-caveat" id="id45">注意</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="callpolicies">
<span id="concepts-callpolicies"></span><h2><a class="toc-backref" href="#id26">CallPolicies コンセプト</a><a class="headerlink" href="#callpolicies" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="concepts-callpolicies-introduction">
<span id="id3"></span><h3><a class="toc-backref" href="#id27">はじめに</a><a class="headerlink" href="#concepts-callpolicies-introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>CallPolicies コンセプトのモデルは、Boost.Python が生成した Python の呼び出し可能オブジェクトの振る舞いを、関数やメンバ関数ポインタのようなラップした C++ オブジェクトに対して特殊化するのに使用する。以下の 4 つの振る舞いを提供する。</p>
<ol class="arabic simple">
<li><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">precall</span></code> ― ラップしたオブジェクトが呼び出される前の Python 引数タプルの管理</p></li>
<li><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">result_converter</span></code> ― C++ 戻り値の処理</p></li>
<li><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">postcall</span></code> ― ラップしたオブジェクトが呼び出された後の Python 引数タプルと戻り値の管理</p></li>
<li><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">extract_return_type</span></code> ― 与えられたシグニチャ型並びから戻り値の型を抽出するメタ関数</p></li>
</ol>
</div>
<div class="section" id="concepts-callpolicies-callpolicies-composition">
<span id="id4"></span><h3><a class="toc-backref" href="#id28">CallPolicies の合成</a><a class="headerlink" href="#concepts-callpolicies-callpolicies-composition" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ユーザが同じ呼び出し可能オブジェクトで複数の CallPolicies モデルを使用可能にするため、Boost.Python の CallPolicies クラステンプレートは再帰的に合成可能な数珠繋ぎのインターフェイスを提供する。このインターフェイスは省略可能なテンプレート引数 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">Base</span></code> を取り、既定は <a class="reference internal" href="default_call_policies.html#_CPPv4N5boost6python21default_call_policiesE" title="boost::python::default_call_policies"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">default_call_policies</span></code></a> である。慣習に従って、<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">Base</span></code> の <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">precall</span></code> 関数はより外側のテンプレートが与えた <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">precall</span></code> 関数の<strong>後で</strong>呼び出され、<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">Base</span></code> の <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">postcall</span></code> 関数はより外側のテンプレートの <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">postcall</span></code> 関数より<strong>前に</strong>呼び出される。より外側のテンプレートで <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">result_converter</span></code> が与えられた場合、<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">Base</span></code> で与えた <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">result_converter</span></code> は<strong>上書きされる</strong>。例えば <a class="reference internal" href="return_internal_reference.html#_CPPv4I_NSt6size_tE0EN5boost6python25return_internal_referenceE" title="boost::python::return_internal_reference"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">return_internal_reference</span></code></a> を見よ。</p>
</div>
<div class="section" id="concepts-callpolicies-concept-requirements">
<span id="id5"></span><h3><a class="toc-backref" href="#id29">コンセプトの要件</a><a class="headerlink" href="#concepts-callpolicies-concept-requirements" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="callpolicies-callpolicies-concept">
<span id="id6"></span><h4>CallPolicies コンセプト<a class="headerlink" href="#callpolicies-callpolicies-concept" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>以下の表で <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">x</span></code> は CallPolicies のモデルである型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">P</span></code> のオブジェクト、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> は Python の引数タプルオブジェクトを指す <code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject*</span></code> 、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">r</span></code> は「予備的な」戻り値オブジェクトを参照する <code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject*</span></code> を表す。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>式</p></th>
<th class="head"><p>型</p></th>
<th class="head"><p>結果・セマンティクス</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">x</span><span class="pre">.</span><span class="pre">precall</span><span class="pre">(</span><span class="pre">a</span><span class="pre">)</span></code></p></td>
<td><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">bool</span></code> へ変換可能</p></td>
<td><p>失敗時は <code class="docutils literal notranslate"><span class="pre">false</span></code> および <a class="reference external" href="http://docs.python.jp/2/c-api/exceptions.html#PyErr_Occurred">PyErr_Occurred</a><code class="code docutils literal notranslate"><span class="pre">()</span> <span class="pre">!=</span> <span class="pre">0</span></code> 、それ以外は <code class="docutils literal notranslate"><span class="pre">true</span></code>。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">P</span><span class="pre">::</span><span class="pre">result_converter</span></code></p></td>
<td><p><a class="reference internal" href="#concepts-resultconverter-resultconvertergenerator-concept"><span class="std std-ref">ResultConverterGenerator</span></a> のモデル&lt;/td&gt;</p></td>
<td><p>「予備的な」戻り値オブジェクトを生成する MPL の単項<a class="reference external" href="http://www.boost.org/libs/mpl/doc/refmanual/metafunction-class.html">メタ関数クラス</a>。</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">x</span><span class="pre">.</span><span class="pre">postcall</span><span class="pre">(</span><span class="pre">a</span><span class="pre">,</span> <span class="pre">r</span><span class="pre">)</span></code></p></td>
<td><p><code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject*</span></code> へ変換可能</p></td>
<td><p>失敗時は <code class="docutils literal notranslate"><span class="pre">0</span></code> および <a class="reference external" href="http://docs.python.jp/2/c-api/exceptions.html#PyErr_Occurred">PyErr_Occurred</a><code class="code docutils literal notranslate"><span class="pre">()</span> <span class="pre">!=</span> <span class="pre">0</span></code>。例外送出中であっても「参照を保持」しなければならない。言い換えると、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">r</span></code> を返さない場合はその参照カウントを減らさなければならず、別の生存しているオブジェクトを返す場合はその参照カウントを増やさなければならない。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">P</span><span class="pre">::</span><span class="pre">extract_return_type</span></code></p></td>
<td><p><a class="reference external" href="http://www.boost.org/libs/mpl/doc/refmanual/metafunction.html">Metafunction</a> のモデル</p></td>
<td><p>与えられたシグニチャから戻り値の型を抽出する MPL の単項 <a class="reference external" href="http://www.boost.org/libs/mpl/doc/refmanual/metafunction.html">Metafunction</a>。既定では <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">mpl::front</span></code> から導出する。</p></td>
</tr>
</tbody>
</table>
<p>CallPolicies のモデルは <a class="reference external" href="http://www.boost.org/libs/utility/CopyConstructible.html">CopyConstructible</a> であることが要求される。</p>
</div>
</div>
</div>
<div class="section" id="dereferenceable">
<span id="concepts-dereferenceable"></span><h2><a class="toc-backref" href="#id30">Dereferenceable コンセプト</a><a class="headerlink" href="#dereferenceable" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="concepts-dereferenceable-introduction">
<span id="id10"></span><h3><a class="toc-backref" href="#id31">はじめに</a><a class="headerlink" href="#concepts-dereferenceable-introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Dereferenceable 型のインスタンスは lvalue へアクセスするポインタのように使用できる。</p>
</div>
<div class="section" id="concepts-dereferenceable-concept-requirements">
<span id="id11"></span><h3><a class="toc-backref" href="#id32">コンセプトの要件</a><a class="headerlink" href="#concepts-dereferenceable-concept-requirements" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="dereferenceable-dereferenceable-concept">
<span id="id12"></span><h4>Dereferenceable コンセプト<a class="headerlink" href="#dereferenceable-dereferenceable-concept" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>以下の表で <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">T</span></code> は Dereferenceable のモデル、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">x</span></code> は型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">T</span></code> のオブジェクトを表す。またポインタはすべて Dereferenceable とする。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>式</p></th>
<th class="head"><p>結果</p></th>
<th class="head"><p>操作上のセマンティクス</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">get_pointer</span><span class="pre">(</span><span class="pre">x</span><span class="pre">)</span></code></p></td>
<td><p><a class="reference internal" href="pointee.html#_CPPv4I0EN5boost6python7pointeeE" title="boost::python::pointee"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pointee</span></code></a><code class="code docutils literal notranslate"><span class="pre">&lt;&gt;::type*</span></code> へ変換可能</p></td>
<td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">&amp;</span><span class="pre">*</span><span class="pre">x</span></code> かヌルポインタ</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="extractor">
<span id="concepts-extractor"></span><h2><a class="toc-backref" href="#id33">Extractor コンセプト</a><a class="headerlink" href="#extractor" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="concepts-extractor-introduction">
<span id="id13"></span><h3><a class="toc-backref" href="#id34">はじめに</a><a class="headerlink" href="#concepts-extractor-introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Extractor は、Boost.Python が Python オブジェクトから C++ オブジェクトを抽出するのに使用するクラスである。典型的には、「伝統的な」Python 拡張型について <code class="docutils literal notranslate"><span class="pre">from_python</span></code> 変換を定義するのに使用する。</p>
</div>
<div class="section" id="concepts-extractor-concept-requirements">
<span id="id14"></span><h3><a class="toc-backref" href="#id35">コンセプトの要件</a><a class="headerlink" href="#concepts-extractor-concept-requirements" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="extractor-extractor-concept">
<span id="id15"></span><h4>Extractor コンセプト<a class="headerlink" href="#extractor-extractor-concept" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>以下の表で <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">X</span></code> は Extractor のモデル、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> は Python オブジェクト型のインスタンスを表す。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>式</p></th>
<th class="head"><p>型</p></th>
<th class="head"><p>セマンティクス</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">X</span><span class="pre">::</span><span class="pre">execute</span><span class="pre">(</span><span class="pre">a</span><span class="pre">)</span></code></p></td>
<td><p>非 void</p></td>
<td><p>抽出する C++ オブジェクトを返す。<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">execute</span></code> 関数は多重定義してはならない。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">&amp;</span><span class="pre">a</span><span class="pre">.</span><span class="pre">ob_type</span></code></p></td>
<td><p><a class="reference external" href="http://docs.python.jp/2/c-api/typeobj.html">PyTypeObject</a><code class="code docutils literal notranslate"><span class="pre">**</span></code></p></td>
<td><p><code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject</span></code> とレイアウト互換なオブジェクトの <code class="xref c c-member docutils literal notranslate"><span class="pre">ob_type</span></code> フィールドを指す。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="concepts-extractor-notes">
<span id="id16"></span><h4>注意事項<a class="headerlink" href="#concepts-extractor-notes" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>簡単に言うと、Extractor の <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">execute</span></code> メンバは多重定義のない、Python オブジェクト型を 1 つだけ引数にとる静的関数でなければならない。<code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject</span></code> から公開派生した（かつあいまいでない継承関係にある）型、および <code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject</span></code> とレイアウト互換な <a class="reference internal" href="../glossary.html#term-POD"><span class="xref std std-term">POD</span></a> 型もこの Python オブジェクト型に含まれる。</p>
</div>
</div>
</div>
<div class="section" id="holdergenerator">
<span id="concepts-holdergenerator"></span><h2><a class="toc-backref" href="#id36">HolderGenerator コンセプト</a><a class="headerlink" href="#holdergenerator" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="concepts-holdergenerator-introduction">
<span id="id17"></span><h3><a class="toc-backref" href="#id37">はじめに</a><a class="headerlink" href="#concepts-holdergenerator-introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>HolderGenerator はその引数のインスタンスを、ラップした C++ クラスインスタンス内に保持するのに適した型を返す単項メタ関数クラスである。</p>
</div>
<div class="section" id="concepts-holdergenerator-concept-requirements">
<span id="id18"></span><h3><a class="toc-backref" href="#id38">コンセンプトの要件</a><a class="headerlink" href="#concepts-holdergenerator-concept-requirements" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="holdergenerator-holdergenerator-concept">
<span id="id19"></span><h4>HolderGenerator コンセプト<a class="headerlink" href="#holdergenerator-holdergenerator-concept" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>以下の表で <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">G</span></code> は HolderGenerator のモデル型、<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">X</span></code> はクラス型を表す。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>式</p></th>
<th class="head"><p>要件</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">G</span><span class="pre">::</span><span class="pre">apply</span><span class="pre">&lt;</span><span class="pre">X</span><span class="pre">&gt;</span><span class="pre">::</span><span class="pre">type</span></code></p></td>
<td><p>型 <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">X</span></code> のオブジェクトを保持できる <a class="reference internal" href="instance_holder.html#_CPPv4N5boost6python15instance_holderE" title="boost::python::instance_holder"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">instance_holder</span></code></a> の具象派生クラス。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="resultconverter-resultconvertergenerator">
<span id="concepts-resultconverter"></span><h2><a class="toc-backref" href="#id39">ResultConverter/ResultConverterGenerator コンセプト</a><a class="headerlink" href="#resultconverter-resultconvertergenerator" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="concepts-resultconverter-introduction">
<span id="id20"></span><h3><a class="toc-backref" href="#id40">はじめに</a><a class="headerlink" href="#concepts-resultconverter-introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">T</span></code> に対する ResultConverter は、型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">T</span></code> の C++ 戻り値を <code class="docutils literal notranslate"><span class="pre">to_python</span></code> 変換するのにそのインスタンスが使用可能な型である。ResultConverterGenerator は、C++ 関数の戻り値型が与えられたときにその型に対する ResultConverter を返す MPL の単項メタ関数クラスである。Boost.Python における ResultConverter は一般的にライブラリの変換器レジストリを探索して適切な変換器を探すが、レジストリを使用しない変換器もありうる。</p>
</div>
<div class="section" id="concepts-resultconverter-resultconverter-concept-requirem">
<span id="id21"></span><h3><a class="toc-backref" href="#id41">コンセプトの要件</a><a class="headerlink" href="#concepts-resultconverter-resultconverter-concept-requirem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="resultconverter">
<span id="resultconverter-resultconverter-concept"></span><h4>ResultConverter コンセプト<a class="headerlink" href="#resultconverter" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>以下の表で <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">C</span></code> は型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> に対する ResultConverter 、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">c</span></code> は型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">C</span></code> のオブジェクト、<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">r</span></code> は型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> のオブジェクトを表す。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>式</p></th>
<th class="head"><p>型</p></th>
<th class="head"><p>セマンティクス</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">C</span> <span class="pre">c;</span></code></p></td>
<td></td>
<td><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">C</span></code> のオブジェクトを構築する。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">c</span><span class="pre">.</span><span class="pre">convertible</span><span class="pre">(</span><span class="pre">)</span></code></p></td>
<td><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">bool</span></code> へ変換可能</p></td>
<td><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> の値から Python オブジェクトへの変換が不可能な場合は <code class="docutils literal notranslate"><span class="pre">false</span></code>。</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">c</span><span class="pre">(</span><span class="pre">r</span><span class="pre">)</span></code></p></td>
<td><p><code class="xref c c-type docutils literal notranslate"><span class="pre">PyObject*</span></code> へ変換可能</p></td>
<td><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">v</span></code> に対応する Python オブジェクトへのポインタ。<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">r</span></code> が <code class="docutils literal notranslate"><span class="pre">to_python</span></code> 変換不可能な場合は <code class="docutils literal notranslate"><span class="pre">0</span></code> で、<a class="reference external" href="http://docs.python.jp/2/c-api/exceptions.html#PyErr_Occurred">PyErr_Occurred</a> は非 <code class="docutils literal notranslate"><span class="pre">0</span></code> を返すはずである。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">c</span><span class="pre">.</span><span class="pre">get_pytype</span><span class="pre">(</span><span class="pre">)</span></code></p></td>
<td><p><code class="xref c c-type docutils literal notranslate"><span class="pre">PyTypeObject</span> <span class="pre">const*</span></code></p></td>
<td><p>変換の結果に対応する Python の型オブジェクトへのポインタか <code class="docutils literal notranslate"><span class="pre">0</span></code>。ドキュメンテーションの生成に使用する。<code class="docutils literal notranslate"><span class="pre">0</span></code> を返した場合はドキュメンテーション内で生成された型は「<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">object</span></code>」になる。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="resultconvertergenerator">
<span id="concepts-resultconverter-resultconvertergenerator-concept"></span><h4>ResultConverterGenerator コンセプト<a class="headerlink" href="#resultconvertergenerator" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>以下の表で <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">G</span></code> は ResultConverterGenerator 型、<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> は C++ 関数の戻り値型。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>式</p></th>
<th class="head"><p>要件</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">G</span><span class="pre">::</span><span class="pre">apply</span><span class="pre">&lt;</span><span class="pre">R</span><span class="pre">&gt;</span><span class="pre">::</span><span class="pre">type</span></code></p></td>
<td><p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> に対する ResultConverter 型。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="objectwrapper-typewrapper">
<span id="concepts-objectwrapper"></span><h2><a class="toc-backref" href="#id42">ObjectWrapper/TypeWrapper コンセプト</a><a class="headerlink" href="#objectwrapper-typewrapper" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="concepts-objectwrapper-introduction">
<span id="id23"></span><h3><a class="toc-backref" href="#id43">はじめに</a><a class="headerlink" href="#concepts-objectwrapper-introduction" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Python オブジェクトを管理するクラスと Python 風の構文をサポートするクラスを表現する、2 つのコンセプトを定義する。</p>
</div>
<div class="section" id="concepts-objectwrapper-objectwrapper-concept-requiremen">
<span id="id24"></span><h3><a class="toc-backref" href="#id44">コンセプトの要件</a><a class="headerlink" href="#concepts-objectwrapper-objectwrapper-concept-requiremen" title="このヘッドラインへのパーマリンク">¶</a></h3>
<div class="section" id="objectwrapper">
<span id="objectwrapper-objectwrapper-concept"></span><h4>ObjectWrapper コンセプト<a class="headerlink" href="#objectwrapper" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>ObjectWrapper コンセプトのモデルは公開アクセス可能な基底クラスとして <a class="reference internal" href="object.html#_CPPv4N5boost6python6objectE" title="boost::python::object"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">object</span></code></a> を持ち、特殊な構築の振る舞いとメンバ関数（テンプレートメンバ関数であることが多い）による便利な機能を提供する。戻り値の型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> 自身が <code class="xref cpp cpp-concept docutils literal notranslate"><span class="pre">TypeWrapper</span></code> である場合を除いて、次のメンバ関数呼び出し形式は</p>
<pre class="literal-block">x.<code class="samp docutils literal notranslate"><em><span class="pre">some_function</span></em></code>(a1, a2,...a<code class="samp docutils literal notranslate"><em><span class="pre">n</span></em></code>)</pre>
<p>常に以下と同じセマンティクスを持つ。</p>
<pre class="literal-block"><a class="reference internal" href="extract.html#_CPPv4I0EN5boost6python7extractE" title="boost::python::extract"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">extract</span></code></a>&lt;R&gt;(x.attr(&quot;some_function&quot;)(<a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a1), <a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a2),...<a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a<code class="samp docutils literal notranslate"><em><span class="pre">n</span></em></code>)))()</pre>
<p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">R</span></code> が <code class="xref cpp cpp-concept docutils literal notranslate"><span class="pre">TypeWrapper</span></code> である場合、戻り値の型は直接以下により構築する。</p>
<pre class="literal-block">x.attr(&quot;some_function&quot;)(<a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a1), <a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a2),...<a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a<code class="samp docutils literal notranslate"><em><span class="pre">n</span></em></code>)).ptr()</pre>
<p>（ただし以下の<a class="reference internal" href="#concepts-objectwrapper-caveat"><span class="std std-ref">注意</span></a>も見よ。）</p>
</div>
<div class="section" id="typewrapper">
<span id="concepts-objectwrapper-typewrapper-concept-requirements"></span><h4>TypeWrapper コンセプト<a class="headerlink" href="#typewrapper" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>TypeWrapper は個々の Python の型 <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">X</span></code> と一体となった ObjectWrapper の改良版である。TypeWrapper として <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">T</span></code> があるとすると、</p>
<pre class="literal-block">T(a1, a2,...a<code class="samp docutils literal notranslate"><em><span class="pre">n</span></em></code>)</pre>
<p>上記の合法なコンストラクタ式は、以下に相当する引数列で <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">X</span></code> を呼び出した結果を管理する新しい <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">T</span></code> オブジェクトを構築する。</p>
<pre class="literal-block"><a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a1), <a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a2),...<a class="reference internal" href="object.html#_CPPv4N5boost6python6object6objectEv" title="boost::python::object::object"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object</span></code></a>(a<code class="samp docutils literal notranslate"><em><span class="pre">n</span></em></code>)</pre>
<p>ラップした C++ 関数の引数、あるいは <a class="reference internal" href="extract.html#_CPPv4I0EN5boost6python7extractE" title="boost::python::extract"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">extract&lt;&gt;</span></code></a> のテンプレート引数として使用した場合、対応する Python 型のインスタンスだけがマッチするとみなされる。</p>
</div>
</div>
<div class="section" id="concepts-objectwrapper-caveat">
<span id="id25"></span><h3><a class="toc-backref" href="#id45">注意</a><a class="headerlink" href="#concepts-objectwrapper-caveat" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>戻り値の型が TypeWrapper である場合の特殊なメンバ関数の呼び出し規則は結論として、返されたオブジェクトが不適切な型の Python オブジェクトを管理している可能がある。これは大抵の場合、深刻な問題とはならない（最悪の場合の結果は、エラーが実行時に検出される場合、つまり他のあらゆる場合よりも少し遅いタイミングだ）。このようなことが起こる例として、<a class="reference internal" href="dict.html#_CPPv4N5boost6python4dictE" title="boost::python::dict"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">dict</span></code></a> のメンバ関数 <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">items</span></code> が <a class="reference internal" href="list.html#_CPPv4N5boost6python4listE" title="boost::python::list"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">list</span></code></a> 型のオブジェクトを返すことに注意していただきたい。今、ユーザがこの <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">dict</span></code> の派生クラスを Python 内で定義すると、</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">mydict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="c1"># タプルを返す</span>
</pre></div>
</div>
<p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">mydict</span></code> のインスタンスは <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">dict</span></code> のインスタンスでもあるため、ラップした C++ 関数の引数として使用すると、<a class="reference internal" href="dict.html#_CPPv4N5boost6python4dictE" title="boost::python::dict"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">boost::python::dict</span></code></a> は Python の <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">mydict</span></code> 型オブジェクトも受け取る。このオブジェクトに対して <code class="xref cpp cpp-expr docutils literal notranslate"><span class="pre">items</span><span class="pre">(</span><span class="pre">)</span></code> を呼び出すと、実際には Python のタプルを保持した <a class="reference internal" href="list.html#_CPPv4N5boost6python4listE" title="boost::python::list"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">boost::python::list</span></code></a> のインスタンスが返る。このオブジェクトで続けて <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">list</span></code> のメソッド（例えば <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">append</span></code> 等、変更を伴う操作）を使用すると、同じことを Python で行った場合と同様の例外が送出する。</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="components.html" class="btn btn-neutral float-right" title="高水準コンポーネント" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../reference.html" class="btn btn-neutral float-left" title="リファレンスマニュアル" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; 著作権 2020, exeal

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>